{
  "name": "Ray AI ç®¡å®¶ â€” é»å­æ”¶é›† v2",
  "nodes": [
    {
      "parameters": {
        "updates": ["message", "callback_query"],
        "additionalFields": {}
      },
      "id": "tg-trigger-001",
      "name": "Telegram Trigger",
      "type": "n8n-nodes-base.telegramTrigger",
      "typeVersion": 1.1,
      "position": [0, 300],
      "credentials": {
        "telegramApi": {
          "id": "TELEGRAM_CREDENTIAL_ID",
          "name": "Ray AI ç®¡å®¶ Bot"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": { "caseSensitive": true, "leftValue": "" },
                "conditions": [{ "leftValue": "={{ $json.callback_query }}", "rightValue": "", "operator": { "type": "string", "operation": "exists" } }],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "callback"
            },
            {
              "conditions": {
                "options": { "caseSensitive": true, "leftValue": "" },
                "conditions": [{ "leftValue": "={{ $json.message }}", "rightValue": "", "operator": { "type": "string", "operation": "exists" } }],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "message"
            }
          ]
        },
        "options": {}
      },
      "id": "switch-event-type",
      "name": "Route Event Type",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3,
      "position": [220, 300]
    },
    {
      "parameters": {
        "conditions": {
          "options": { "caseSensitive": false, "leftValue": "" },
          "conditions": [
            { "id": "f1", "leftValue": "={{ $json.message.text.length }}", "rightValue": 5, "operator": { "type": "number", "operation": "gt" } },
            { "id": "f2", "leftValue": "={{ $json.message.text }}", "rightValue": "/", "operator": { "type": "string", "operation": "notStartsWith" } }
          ],
          "combinator": "and"
        }
      },
      "id": "filter-001",
      "name": "Filter Short & Commands",
      "type": "n8n-nodes-base.filter",
      "typeVersion": 2,
      "position": [440, 400]
    },
    {
      "parameters": {
        "jsCode": "// Build Claude messages with conversation history\nconst chatId = $json.message.chat.id;\nconst messageText = $json.message.text;\nconst staticData = $getWorkflowStaticData('global');\n\n// Clean stale conversations (>24h)\nconst now = Date.now();\nconst ONE_DAY = 24 * 60 * 60 * 1000;\nfor (const key of Object.keys(staticData)) {\n  if (key.startsWith('idea_')) {\n    const entry = staticData[key];\n    if (entry && entry.timestamp && (now - entry.timestamp) > ONE_DAY) {\n      const suffix = key.replace('idea_', '');\n      delete staticData[key];\n      delete staticData[`history_${suffix}`];\n    }\n  }\n}\n\nconst existingHistory = staticData[`history_${chatId}`] || [];\nconst messages = [...existingHistory, { role: 'user', content: messageText }];\nconst isContinuation = existingHistory.length > 0;\n\nreturn [{\n  json: {\n    chatId,\n    messageText,\n    messages,\n    isContinuation,\n    originalData: $json\n  }\n}];"
      },
      "id": "code-build-messages",
      "name": "Build Claude Messages",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [660, 400]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.anthropic.com/v1/messages",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            { "name": "x-api-key", "value": "={{ $credentials.httpHeaderAuth.value }}" },
            { "name": "anthropic-version", "value": "2023-06-01" },
            { "name": "content-type", "value": "application/json" }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify({ model: 'claude-haiku-4-5-20251001', max_tokens: 1000, system: 'ä½ æ˜¯ Ray çš„ AI ç®¡å®¶ Alfredã€‚ä½ çš„å·¥ä½œæ˜¯å¹« Ray åˆ†æä»–çš„æƒ³æ³•å’Œé»å­ã€‚\\n\\nç•¶ Ray å‚³ä¾†æƒ³æ³•æ™‚ï¼Œè«‹ï¼š\\n1. ç”¨ç¹é«”ä¸­æ–‡å‹å–„åœ°åˆ†æé€™å€‹æƒ³æ³•ï¼ˆ3-5å¥ï¼‰ï¼š\\n   - æ ¸å¿ƒæ¦‚å¿µæ˜¯ä»€éº¼\\n   - å¯è¡Œæ€§å¦‚ä½•\\n   - ä½ çš„å»ºè­°æˆ–æ”¹é€²æ–¹å‘\\n   - é¡ä¼¼çš„æˆåŠŸæ¡ˆä¾‹ï¼ˆå¦‚æœæœ‰ï¼‰\\n\\n2. åœ¨æœ€å¾ŒåŠ ä¸Šçµæ§‹åŒ–è³‡æ–™ï¼Œç”¨ ---JSON--- åˆ†éš”ï¼š\\n\\n---JSON---\\n{\"title\": \"æƒ³æ³•æ‘˜è¦ï¼ˆç¹é«”ä¸­æ–‡ï¼Œ30å­—å…§ï¼‰\", \"type\": \"é¸ä¸€å€‹ï¼šğŸ’° è³£éŒ¢é»å­ / ğŸ“¹ å½±ç‰‡é»å­ / ğŸ› ï¸ å·¥å…·/è‡ªå‹•åŒ– / ğŸ“ å…§å®¹é»å­ / ğŸŒŸ äººç”Ÿç›®æ¨™ / ğŸ¤” å…¶ä»–\", \"priority\": \"é¸ä¸€å€‹ï¼šğŸ”¥ é«˜ / â­ ä¸­ / ğŸ“Œ ä½\", \"notes\": \"åŸå§‹è¨Šæ¯ + ä½ çš„åˆ†æé‡é»æ‘˜è¦\"}\\n\\nå¦‚æœæ˜¯å»¶çºŒä¹‹å‰çš„å°è©±ï¼Œç¹¼çºŒæ·±å…¥è¨è«–ï¼Œä¸¦åœ¨æœ€å¾Œæ›´æ–° JSON åˆ†é¡ã€‚', messages: $json.messages }) }}",
        "options": {
          "response": { "response": { "responseFormat": "json" } }
        }
      },
      "id": "claude-001",
      "name": "Claude Analyze Idea",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [880, 400],
      "credentials": {
        "httpHeaderAuth": {
          "id": "ANTHROPIC_CREDENTIAL_ID",
          "name": "Anthropic API Key"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Parse Claude response: split analysis from JSON, store state\nconst content = $input.first().json;\nlet text = '';\nif (content.content && content.content[0] && content.content[0].text) {\n  text = content.content[0].text;\n}\n\nconst chatId = $('Build Claude Messages').first().json.chatId;\nconst messageText = $('Build Claude Messages').first().json.messageText;\nconst messages = $('Build Claude Messages').first().json.messages;\n\n// Split into analysis and JSON\nlet analysis = text;\nlet jsonData = null;\nconst separator = '---JSON---';\nconst sepIdx = text.indexOf(separator);\n\nif (sepIdx !== -1) {\n  analysis = text.substring(0, sepIdx).trim();\n  let jsonStr = text.substring(sepIdx + separator.length).trim();\n  jsonStr = jsonStr.replace(/```json\\n?/g, '').replace(/```\\n?/g, '').trim();\n  try {\n    jsonData = JSON.parse(jsonStr);\n  } catch (e) {\n    jsonData = { title: messageText.substring(0, 30), type: 'ğŸ¤” å…¶ä»–', priority: 'â­ ä¸­', notes: messageText };\n  }\n} else {\n  jsonData = { title: messageText.substring(0, 30), type: 'ğŸ¤” å…¶ä»–', priority: 'â­ ä¸­', notes: messageText };\n}\n\n// Store state\nconst staticData = $getWorkflowStaticData('global');\nstaticData[`idea_${chatId}`] = {\n  analysis,\n  data: jsonData,\n  originalMessage: messageText,\n  timestamp: Date.now(),\n  date: new Date().toISOString().split('T')[0]\n};\n\n// Update conversation history\nstaticData[`history_${chatId}`] = [...messages, { role: 'assistant', content: analysis }];\n\nreturn [{\n  json: {\n    chatId,\n    analysis,\n    title: jsonData.title,\n    type: jsonData.type,\n    priority: jsonData.priority\n  }\n}];"
      },
      "id": "code-parse-state",
      "name": "Parse + Store State",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1100, 400]
    },
    {
      "parameters": {
        "jsCode": "// Build Telegram reply with inline keyboard buttons\nconst chatId = $json.chatId;\nconst analysis = $json.analysis;\nconst title = $json.title;\nconst type = $json.type;\nconst priority = $json.priority;\n\nconst messageText = `ğŸ§  *Alfred åˆ†æ*\\n\\n${analysis}\\n\\nğŸ“‹ *åˆ†é¡é è¦½ï¼š*\\nğŸ“Œ ${title}\\nğŸ·ï¸ ${type} Â· ${priority}\\n\\nè¦å­˜å…¥ Notion å—ï¼Ÿ`;\n\nconst replyMarkup = JSON.stringify({\n  inline_keyboard: [\n    [\n      { text: 'âœ… å­˜å…¥', callback_data: 'save_idea' },\n      { text: 'âŒ ä¸å­˜å…¥', callback_data: 'skip_idea' }\n    ],\n    [\n      { text: 'ğŸ’¬ ç¹¼çºŒè¨è«–', callback_data: 'discuss_more' }\n    ]\n  ]\n});\n\nreturn [{ json: { chatId, messageText, replyMarkup } }];"
      },
      "id": "code-build-reply",
      "name": "Build Reply Payload",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1320, 400]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://api.telegram.org/bot{{ $credentials.telegramApi.token }}/sendMessage",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify({ chat_id: $json.chatId, text: $json.messageText, parse_mode: 'Markdown', reply_markup: $json.replyMarkup }) }}",
        "options": {}
      },
      "id": "tg-send-analysis",
      "name": "Send Analysis + Buttons",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [1540, 400],
      "credentials": {
        "telegramApi": {
          "id": "TELEGRAM_CREDENTIAL_ID",
          "name": "Ray AI ç®¡å®¶ Bot"
        }
      }
    },

    {
      "parameters": {
        "jsCode": "// Extract callback data and answer the callback query\nconst cq = $json.callback_query;\nconst chatId = cq.message.chat.id;\nconst callbackId = cq.id;\nconst callbackData = cq.data;\nconst messageId = cq.message.message_id;\n\nreturn [{\n  json: { chatId, callbackId, callbackData, messageId }\n}];"
      },
      "id": "code-extract-callback",
      "name": "Extract Callback Data",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [440, 200]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://api.telegram.org/bot{{ $credentials.telegramApi.token }}/answerCallbackQuery",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify({ callback_query_id: $json.callbackId }) }}",
        "options": {}
      },
      "id": "tg-answer-callback",
      "name": "Answer Callback",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [660, 200],
      "credentials": {
        "telegramApi": {
          "id": "TELEGRAM_CREDENTIAL_ID",
          "name": "Ray AI ç®¡å®¶ Bot"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": { "caseSensitive": true, "leftValue": "" },
                "conditions": [{ "leftValue": "={{ $json.callbackData }}", "rightValue": "save_idea", "operator": { "type": "string", "operation": "equals" } }],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "save"
            },
            {
              "conditions": {
                "options": { "caseSensitive": true, "leftValue": "" },
                "conditions": [{ "leftValue": "={{ $json.callbackData }}", "rightValue": "skip_idea", "operator": { "type": "string", "operation": "equals" } }],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "skip"
            },
            {
              "conditions": {
                "options": { "caseSensitive": true, "leftValue": "" },
                "conditions": [{ "leftValue": "={{ $json.callbackData }}", "rightValue": "discuss_more", "operator": { "type": "string", "operation": "equals" } }],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "discuss"
            }
          ]
        },
        "options": {}
      },
      "id": "switch-callback",
      "name": "Route Callback",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3,
      "position": [880, 200]
    },

    {
      "parameters": {
        "jsCode": "// SAVE: Retrieve stored state and prepare for Notion\nconst chatId = $json.chatId;\nconst messageId = $json.messageId;\nconst staticData = $getWorkflowStaticData('global');\nconst stored = staticData[`idea_${chatId}`];\n\nif (!stored) {\n  return [{ json: { chatId, messageId, error: true, errorMsg: 'âš ï¸ æ‰¾ä¸åˆ°å¾…å­˜çš„æƒ³æ³•ï¼Œå¯èƒ½å·²éæœŸã€‚è«‹é‡æ–°å‚³é€ã€‚' } }];\n}\n\nconst result = {\n  chatId,\n  messageId,\n  title: stored.data.title || 'æœªåˆ†é¡æƒ³æ³•',\n  type: stored.data.type || 'ğŸ¤” å…¶ä»–',\n  priority: stored.data.priority || 'â­ ä¸­',\n  notes: stored.data.notes || stored.originalMessage,\n  date: stored.date,\n  analysis: stored.analysis,\n  error: false\n};\n\n// Clean up state\ndelete staticData[`idea_${chatId}`];\ndelete staticData[`history_${chatId}`];\n\nreturn [{ json: result }];"
      },
      "id": "code-retrieve-state",
      "name": "Retrieve State",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1100, 100]
    },
    {
      "parameters": {
        "resource": "databasePage",
        "operation": "create",
        "databaseId": { "__rl": true, "value": "ed035c908cc04b7b999ef0c023557add", "mode": "id" },
        "title": "={{ $json.title }}",
        "propertiesUi": {
          "propertyValues": [
            { "key": "é¡å‹|select", "selectValue": "={{ $json.type }}" },
            { "key": "ç‹€æ…‹|select", "selectValue": "ğŸ’¡ æ–°æƒ³æ³•" },
            { "key": "å„ªå…ˆåº¦|select", "selectValue": "={{ $json.priority }}" },
            { "key": "å»ºç«‹æ—¥æœŸ|date", "dateValue": "={{ $json.date }}" }
          ]
        },
        "blockUi": {
          "blockValues": [
            { "type": "paragraph", "textContent": "={{ $json.notes }}" },
            { "type": "paragraph", "textContent": "={{ '\\n--- Alfred åˆ†æ ---\\n' + $json.analysis }}" }
          ]
        }
      },
      "id": "notion-create-001",
      "name": "Save to Notion Ideas",
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [1320, 100],
      "credentials": {
        "notionApi": {
          "id": "NOTION_CREDENTIAL_ID",
          "name": "Notion Integration"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Send confirmation + remove buttons\nconst chatId = $('Retrieve State').first().json.chatId;\nconst messageId = $('Retrieve State').first().json.messageId;\nconst title = $('Retrieve State').first().json.title;\nconst type = $('Retrieve State').first().json.type;\nconst priority = $('Retrieve State').first().json.priority;\n\nreturn [{ json: {\n  chatId,\n  messageId,\n  confirmText: `âœ… å·²å­˜å…¥ Notionï¼\\n\\nğŸ“Œ ${title}\\nğŸ·ï¸ ${type} Â· ${priority}`\n} }];"
      },
      "id": "code-confirm-save",
      "name": "Build Save Confirmation",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1540, 100]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://api.telegram.org/bot{{ $credentials.telegramApi.token }}/editMessageReplyMarkup",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify({ chat_id: $json.chatId, message_id: $json.messageId, reply_markup: JSON.stringify({ inline_keyboard: [] }) }) }}",
        "options": {}
      },
      "id": "tg-remove-buttons-save",
      "name": "Remove Buttons (Save)",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [1760, 100],
      "credentials": {
        "telegramApi": { "id": "TELEGRAM_CREDENTIAL_ID", "name": "Ray AI ç®¡å®¶ Bot" }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://api.telegram.org/bot{{ $credentials.telegramApi.token }}/sendMessage",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify({ chat_id: $json.chatId, text: $json.confirmText }) }}",
        "options": {}
      },
      "id": "tg-send-confirm",
      "name": "Send Save Confirm",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [1980, 100],
      "credentials": {
        "telegramApi": { "id": "TELEGRAM_CREDENTIAL_ID", "name": "Ray AI ç®¡å®¶ Bot" }
      }
    },

    {
      "parameters": {
        "jsCode": "// SKIP: Clear state and reply\nconst chatId = $json.chatId;\nconst messageId = $json.messageId;\nconst staticData = $getWorkflowStaticData('global');\ndelete staticData[`idea_${chatId}`];\ndelete staticData[`history_${chatId}`];\n\nreturn [{ json: { chatId, messageId, text: 'å¥½çš„ï¼Œä¸å­˜å…¥ ğŸ‘Œ' } }];"
      },
      "id": "code-skip",
      "name": "Clear State (Skip)",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1100, 250]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://api.telegram.org/bot{{ $credentials.telegramApi.token }}/editMessageReplyMarkup",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify({ chat_id: $json.chatId, message_id: $json.messageId, reply_markup: JSON.stringify({ inline_keyboard: [] }) }) }}",
        "options": {}
      },
      "id": "tg-remove-buttons-skip",
      "name": "Remove Buttons (Skip)",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [1320, 250],
      "credentials": {
        "telegramApi": { "id": "TELEGRAM_CREDENTIAL_ID", "name": "Ray AI ç®¡å®¶ Bot" }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://api.telegram.org/bot{{ $credentials.telegramApi.token }}/sendMessage",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify({ chat_id: $json.chatId, text: $json.text }) }}",
        "options": {}
      },
      "id": "tg-send-skip",
      "name": "Send Skip Reply",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [1540, 250],
      "credentials": {
        "telegramApi": { "id": "TELEGRAM_CREDENTIAL_ID", "name": "Ray AI ç®¡å®¶ Bot" }
      }
    },

    {
      "parameters": {
        "jsCode": "// DISCUSS MORE: Keep state, prompt user to continue\nconst chatId = $json.chatId;\nconst messageId = $json.messageId;\n\nreturn [{ json: {\n  chatId,\n  messageId,\n  text: 'æ²’å•é¡Œï¼ç¹¼çºŒè·Ÿæˆ‘èŠé€™å€‹æƒ³æ³•å§ ğŸ’¬\\n\\nä½ å¯ä»¥è£œå……æ›´å¤šç´°ç¯€ã€æå•ã€æˆ–å‘Šè¨´æˆ‘ä½ çš„ç–‘æ…®ã€‚\\nèŠå®Œä¹‹å¾Œæˆ‘æœƒå†å•ä½ è¦ä¸è¦å­˜å…¥ Notionã€‚'\n} }];"
      },
      "id": "code-discuss",
      "name": "Build Discuss Reply",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1100, 350]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://api.telegram.org/bot{{ $credentials.telegramApi.token }}/editMessageReplyMarkup",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify({ chat_id: $json.chatId, message_id: $json.messageId, reply_markup: JSON.stringify({ inline_keyboard: [] }) }) }}",
        "options": {}
      },
      "id": "tg-remove-buttons-discuss",
      "name": "Remove Buttons (Discuss)",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [1320, 350],
      "credentials": {
        "telegramApi": { "id": "TELEGRAM_CREDENTIAL_ID", "name": "Ray AI ç®¡å®¶ Bot" }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://api.telegram.org/bot{{ $credentials.telegramApi.token }}/sendMessage",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify({ chat_id: $json.chatId, text: $json.text }) }}",
        "options": {}
      },
      "id": "tg-send-discuss",
      "name": "Send Discuss Reply",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [1540, 350],
      "credentials": {
        "telegramApi": { "id": "TELEGRAM_CREDENTIAL_ID", "name": "Ray AI ç®¡å®¶ Bot" }
      }
    }
  ],
  "connections": {
    "Telegram Trigger": {
      "main": [[{ "node": "Route Event Type", "type": "main", "index": 0 }]]
    },
    "Route Event Type": {
      "main": [
        [{ "node": "Extract Callback Data", "type": "main", "index": 0 }],
        [{ "node": "Filter Short & Commands", "type": "main", "index": 0 }]
      ]
    },
    "Filter Short & Commands": {
      "main": [[{ "node": "Build Claude Messages", "type": "main", "index": 0 }]]
    },
    "Build Claude Messages": {
      "main": [[{ "node": "Claude Analyze Idea", "type": "main", "index": 0 }]]
    },
    "Claude Analyze Idea": {
      "main": [[{ "node": "Parse + Store State", "type": "main", "index": 0 }]]
    },
    "Parse + Store State": {
      "main": [[{ "node": "Build Reply Payload", "type": "main", "index": 0 }]]
    },
    "Build Reply Payload": {
      "main": [[{ "node": "Send Analysis + Buttons", "type": "main", "index": 0 }]]
    },

    "Extract Callback Data": {
      "main": [[{ "node": "Answer Callback", "type": "main", "index": 0 }]]
    },
    "Answer Callback": {
      "main": [[{ "node": "Route Callback", "type": "main", "index": 0 }]]
    },
    "Route Callback": {
      "main": [
        [{ "node": "Retrieve State", "type": "main", "index": 0 }],
        [{ "node": "Clear State (Skip)", "type": "main", "index": 0 }],
        [{ "node": "Build Discuss Reply", "type": "main", "index": 0 }]
      ]
    },

    "Retrieve State": {
      "main": [[{ "node": "Save to Notion Ideas", "type": "main", "index": 0 }]]
    },
    "Save to Notion Ideas": {
      "main": [[{ "node": "Build Save Confirmation", "type": "main", "index": 0 }]]
    },
    "Build Save Confirmation": {
      "main": [[{ "node": "Remove Buttons (Save)", "type": "main", "index": 0 }]]
    },
    "Remove Buttons (Save)": {
      "main": [[{ "node": "Send Save Confirm", "type": "main", "index": 0 }]]
    },

    "Clear State (Skip)": {
      "main": [[{ "node": "Remove Buttons (Skip)", "type": "main", "index": 0 }]]
    },
    "Remove Buttons (Skip)": {
      "main": [[{ "node": "Send Skip Reply", "type": "main", "index": 0 }]]
    },

    "Build Discuss Reply": {
      "main": [[{ "node": "Remove Buttons (Discuss)", "type": "main", "index": 0 }]]
    },
    "Remove Buttons (Discuss)": {
      "main": [[{ "node": "Send Discuss Reply", "type": "main", "index": 0 }]]
    }
  },
  "settings": {
    "executionOrder": "v1",
    "saveManualExecutions": true,
    "callerPolicy": "workflowsFromSameOwner"
  },
  "staticData": null,
  "tags": [{ "name": "telegram" }, { "name": "notion" }, { "name": "ai" }],
  "triggerCount": 1,
  "pinData": {}
}
